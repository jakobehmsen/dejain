<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Jasy by jakobehmsen</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Jasy</h1>
        <p>Declarative Java Instrumentation</p>
        <p class="view"><a href="https://github.com/jakobehmsen/jasy">View the Project on GitHub <small>jakobehmsen/jasy</small></a></p>
        <ul>
          <li><a href="https://github.com/jakobehmsen/jasy">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h3>
<a id="welcome-to-the-project-page-of-jasy" class="anchor" href="#welcome-to-the-project-page-of-jasy" aria-hidden="true"><span class="octicon octicon-link"></span></a>Introduction to Jasy</h3>

<p>
Jasy is a declarative Java bytecode instrumentation language with a syntax leaning towards Java. The instrumentation is either expressed in a declarative style or an imperative style using code interpolation.
</p>

<p>Using the declarative style, an example is shown where an extra field is added and the toString method is overridden for all classes being transformed:</p>

<pre><code>class {
    +private String extraField = "Hello World!";

    +public String toString() {
        return "extraField=" + extraField;
    }
}
</code></pre>
      </section>
      <section>
        <h3>
<a id="code-interpolation" class="anchor" href="#code-interpolation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Code Interpolation</h3>

<p>
There are limitations to instrumentation based only on the declarative style in Jasy.
To overcome this, Jasy supports interpolation of imperatively generated code. 
This code is represented by ASTs, where these ASTs may be implictly converted from non-AST values (e.g. Strings and ints) into their corresponding AST represention.
</p>

<p>In the below example, code interpolation is shown where the class name of the class being transformed is explicitly used. This String value is then implicitly converted into a String AST and followingly interpolated into the return statement:</p>

<pre><code>c = class {
    +public String getClassName() {
        return $c.name;
    }
}
</code></pre>
      </section>
	  <section>
        <h3>
<a id="code-interpolation-beyond-expressions" class="anchor" href="#code-interpolation-beyond-expressions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Code Interpolation - Beyond Expressions</h3>

<p>
The previous example of code interpolation involved interpolation of expressions. 
In some cases, it is practical to generate statements - perhaps even in a varying amount and combination.
</p>

<p>For an example of such interpolation, look below where a description method is generated which builds and returns a description of all the instance fields:</p>

<pre><code>class {
    fields = !static;

    +public String getDescription() {
        StringBuilder descriptionBuilder = new StringBuilder();
	
        ${
            for(Field f: fields)
                ^#descriptionBuilder.append($f.name + " = " + $f.value);
        }
		
        return descriptionBuilder.toString();
    }
}
</code></pre>

<p>A <code>^...</code> statement interpolates the result of <code>...</code> at its respective location. A <code>#...</code> returns <code>...</code> as its respective AST representation (except for any embedded <code>$...</code> blocks or expressions.).</p>

<p>For example, the following class</p>

<pre><code>public class Person {
    private String firstName;
    private String lastName;
    private int age;
}
</code></pre>

<p>will be transformed into something like</p>

<pre><code>public class Person {
    ...
	
    public String getDescription() {
        StringBuilder descriptionBuilder = new StringBuilder();
		
        descriptionBuilder.append("firstName" + " = " + firstName);
        descriptionBuilder.append("lastName" + " = " + lastName);
        descriptionBuilder.append("age" + " = " + age);
		
        return descriptionBuilder.toString();
    }
}
</code></pre>

      </section>
    </div>
    <footer>
      <p>Project maintained by <a href="https://github.com/jakobehmsen">jakobehmsen</a></p>
      <p>Hosted on GitHub Pages</p>
    </footer>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>
